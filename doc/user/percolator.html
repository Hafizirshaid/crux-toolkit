<html>
<title>crux percolator</title>
<link href="./crux.css" rel="styleSheet" type="text/css">
</head>
<body>
<blockquote>

<H1 ALIGN=CENTER>crux percolator</H1>

<p>
<b>Usage:</b></p>

<blockquote>
<code>crux percolator [options] &lt;search results&gt; </code>
</blockquote>

<p>
<b>Description:</b></p>

<p>
Percolator is a semi-supervised learning algorithm that dynamically
learns to separate target from decoy peptide-spectrum matches (PSMs).
The algorithm is described in this article:</p>

<blockquote>
Lukas K&auml;ll, Jesse Canterbury, Jason Weston, William Stafford
Noble and Michael
J. MacCoss.  <a href="http://noble.gs.washington.edu/papers/kall2007semi-supervised.html">"Semi-supervised
learning for peptide identification from shotgun proteomics
datasets."</a>
<i>Nature Methods</i>.  4(11):923-925, 2007.
</blockquote>

<p>
For more on q-values and posterior error probabilities (PEP), see the
documentation for <a href="calibrate-scores.html">calibrate-scores</a>.
<p>
<span class=prog>Crux</span> now includes code from
<a href="http://per-colator.com/"><span class=prog>Percolator
2.04</span></a>.</p>

<p>
Percolator requires as input a file in pin.xml format containing two
collections of PSMs, one set derived from matching observed spectra
against real ("target") peptides, and a second derived from matching
the same spectra against "decoy" peptides.</p>

<p>
The features used by Percolator to represent each PSM are summarized
<a href="features.html">here</a>.</p>

<p>
<b>Input:</b></p>

<ul>
<LI>
<b>&lt;search&nbsp;results&gt;</b> &ndash; A collection of target and
decoy peptide-spectrum matches (PSMs) in pin.xml format, defined
according to <a href="percolator_in.xml">this schema</a>.  The
command <code>crux search-for-matches</code> generates results in this
format.  Note that this argument can be "-", which indicates the
pin.xml file should be read from standard input.</li>

</ul>

<B>Output:</B>

<p> Percolator produces the following files in
the <code>crux-output</code> directory:</p>

<ul>

<li>
<b>percolator.pout.xml</b>: an XML file containing all of the
Percolator results, defined according
to <a href="percolator_out.xml">this schema</a>.
</li>

<li>
<b>percolator.target.txt</b>: a tab-delimited file containing the
target PSMs.  See <a href="txt-format.html">here</a> for a list of the
fields.</li>

<li>
<b>percolator.decoy.txt</b>: a tab-delimited file containing the decoy PSMs.
</li>

<li>
<b>percolator.params.txt</b>: a file containing the name and value of
all parameters for the current operation.  Not all parameters in the
file may have been used in the operation.  The resulting file can be
used with the <code>--parameter-file</code> option for other crux
programs.
</li>

<li>
<b>percolator.target.pep.xml</b>: a file containing the PSMs in pepxml
format.
See <a href="http://tools.proteomecenter.org/wiki/index.php?title=Formats:pepXML">
pep xml file format</a> for further reference. This file can be used
as input to some of the tools in the
<a href="http://tools.proteomecenter.org/wiki/index.php?title=Software:TPP">
Transproteomic Pipeline</a>.
</li>

<li>
<b>percolator.log.txt</b>: a log file containing a copy of all
messages that were printed to standard error.
</li>
</ul>

<b>Percolator options:</b>

<ul>

<li>
<code>--decoy-xml-output &lt;T|F&gt;</code> &ndash; Include decoys
(PSMs, peptides and/or proteins) in the XML output. Default = F.</li>

<li>
<code>--decoy-prefix &lt;string&gt;</code> &ndash; Option for single
SQT file mode defining the name pattern used for shuffled
database. Default random_.  <note>I don't think this is
required. --Bill</note></li>

<li>
<code>--c-pos &lt;float&gt;</code> &ndash; Penalty for mistakes made
on positive examples. This value is set via cross validation if it is
not specified. <note>We need to specify the range of values that are
considered in the cross-validation. --Bill</note></li>

<li>
<code>--c-neg &lt;float&gt;</code> &ndash; Penalty for mistakes made
on negative examples. This parameter requires
that <code>--c-pos</code> is set explicitly;
otherwise, <code>--c-neg</code> will have no effect.  Set by cross
validation if not specified.</li>

<li>
<code>--train-fdr &lt;value&gt;</code> &ndash; False discovery rate
threshold to define positive examples in training. Set by cross
validation <note>Over what values? --Bill</note> if 0. Default =
0.01.</li>

<li>
<code>--test-fdr &lt;value&gt;</code> &ndash; False discovery rate
threshold used in selecting hyperparameters during internal
cross-validation and for reporting the final results. Default =
0.01.</li>

<li>
<code>--maxiter &lt;int&gt;</code> &ndash; Maximum number of
iterations for training.  Default = 10.</li>

<li>
<code>--train-ratio &lt;float&gt;</code> &ndash; Fraction of the
negative data set to be used as train set when only providing one
negative set.  The remaining examples will be used as test set.
Default = 0.6.</li>

<li>
<code>--output-feature-file &lt;T|F&gt;</code> &ndash; Output the
computed features in tab-delimited text format to a file
named "percolator.features.txt." Default = F</li>

<li>
<code>--output-weights &lt;T|F&gt; </code>&ndash; Output final weights
to a file named "percolator.weights.txt."  Default = F.</li>

<li>
<code>--input-weights &lt;string&gt;</code> &ndash; Read initial
weights from the given file (one per line). Default = F.</li>

<li>
<code>--default-direction &lt;int&gt;</code> &ndash; In its initial
round of training, Percolator uses one feature to induce a ranking of
PSMs.  By default, Percolator will select the feature that produces
the largest set of target PSMs at a specified FDR threshold
(cf. <code>--train-fdr</code>).  This option allows the user to
specify which feature is used for the initial ranking, using the
indices from <a href="features.html">this table</a>.  The feature
index can be negated to indicate that a lower value is better.</li>

<li>
<code>--unitnorm &lt;T|F&gt;</code> &ndash; Use unit normalization
(i.e., linearly rescale each PSM's feature vector to have a Euclidean
length of 1), instead of standard deviation normalization.  Default =
F.</li>

<li>
<code>--test-each-iteration &lt;T|F&gt;</code> &ndash; Measure
performance on the test set each iteration.  Default = F.</li>

<li>
<code>--static-override &lt;T|F&gt;</code> &ndash; Override error
check and do not fall back on default score vector in case of suspect
score vector.  Default = F.</li>

<li>
<code>--seed &lt;int&gt;</code> &ndash; Set the seed of the random
number generator. Default = 0.</li>

<li>
<code>--klammer &lt;T|F&gt;</code> &ndash; Using retention time
features calculated as in Klammer et al. <note>Give full citation.</note>
</li>

<li> 
<code>--doc &lt;T|F&gt; </code> &ndash; Tell Percolator to use
retention time prediction features (pI and mass difference) in the
training procedure.  Default = F.</li>

<li>
<code>--unique-peptides &lt;T|F&gt;</code> &ndash; Do not remove
redundant peptides; keep all PSMs and exclude peptide level
probability.
</li>

<li>
<code>--no-schema-validation &lt;T|F&gt;</code> &ndash; Skip
validation of input file against xml schema. Default = F.</li>

<li>
<code>--fileroot &lt;string&gt;</code> &ndash;
The <code>fileroot</code> string will be added as a prefix to all
output file names. Default = none.</li>

<li>
<code>--output-dir &lt;filename&gt;</code> &ndash; The name of the
directory where output files will be created.  Default =
crux-output.</li>

<li>
<code>--overwrite &lt;T|F&gt;</code> Replace existing files if true (T) or
fail when trying to overwrite a file if false (F). Default =  F.

<LI>
<code>--parameter-file &lt;filename&gt;</code> &ndash;
A file containing command-line or additional parameters.  See the <a
href=parameter-file.html>parameter documentation</a> page for details.</li>

<LI> 
<code>--feature-file &lt;string&gt;</code> &ndash;
Optional file in which to write the features. Default = none.</li>

<LI>
<code>--verbosity &lt;0-100&gt;</code> &ndash; Specify the verbosity of the
current processes. Each level prints the following messages, including
all those at lower verbosity levels: 0-fatal errors, 10-non-fatal
errors, 20-warnings, 30-information on the progress of execution,
40-more progress information, 50-debug info, 60-detailed debug info.
Default = 30.</li>


</ul>

<b>Protein-level inference options:</b>

<ul>

<li>
<code>--protein &lt;T|F&gt;</code> &ndash; Output protein level
probabilities. If this option is not set, then none of the options
below may be used.  Default = F.</li>

<li>
<code>--alpha &lt;float&gt;</code> &ndash; Specify the probability
with which a present protein emits an associated peptide. Set by grid
search
<note>over what values?</note> if not specified.</li>

<li>
<code>--beta &lt;float&gt;</code> &ndash; Specify the probability of
the creation of a peptide from noise. Set by grid search <note>Over
what values?</note> if not specified.</li>

<li>
<code>--gamma &lt;float&gt;</code> &ndash; Specify the prior
probability that a protein is present in the sample. Set by grid
search of not specified.</li>

<li>
<code>--allow-protein-group &lt;T|F&gt;</code> &ndash; Treat ties as
if it were one protein.  Default = F.</li>

<li>
<code>--protein--level-pi0 &lt;T|F&gt;</code> &ndash; Use pi_0 value
when calculating empirical q-values.  Default = F.</li>

<li>
<code>--empirical-protein-q &lt;T|F&gt;</code> &ndash; Output
empirical q-values (from target-decoy analysis). Default = F.</li>

<li>
<code>--group-proteins &lt;T|F&gt;</code> &ndash; Proteins with same
probabilities will be grouped.  Default = F.</li>

<li>
<code>--no-prune-proteins &lt;T|F&gt;</code> &ndash; Peptides with low
score will not be pruned before calculating protein probabilities.
Default = F.</li>

<li>
<code>--deepness &lt;0|1|2|3&gt;</code> &ndash; Setting deepness 0 or
1 or 2 or 3 from high deepness to low deepness (less computational
time) of the grid search for alpha, beta and gamma estimation. Default
= 3.</li>

</ul>

<p>
<b>Options not supported</b></p>

<ul>

<li>
<code>--input-feature-file &lt;filename&gt;</code> &ndash; Input files
are given as a tab-delimited file. In this case the only argument
should be a file name of the data file.  The tab-delimited fields
should be id &lt;tab&gt; label &lt;tab&gt; feature1 &lt;tab&gt;
... &lt; tab&gt; featureN &lt;tab&gt; peptide &lt;tab&gt; proteinId1
&lt;tab&gt; ... &lt;tab&gt; proteinIdM Labels are interpreted as 1 --
positive set and test set, -1 -- negative</note> set. When the --doc
option is true, the first and second feature (third and fourth column)
should contain the retention time and difference between observed and
calculated mass.</li>

<li>
<code>--clock &lt;T|F&gt;</code> &ndash; Check time performance.</li>

<li>
<code>--exp-mass &lt;T|F&gt;</code> &ndash; Include the experimental
mass in the output file. <note>I think this should always be
true</note></li>

</ul>

<hr></hr>

<a href="crux.html">Crux home</a>

<note>

<p>
To do:</p>

<ul>
<li>
Document the inclusion of Fido and of the retention time
stuff.</li>
<li>
Add note explaining differences between crux percolator and
stand-alone Percolator.</li>
<li>
Complete the feature table and indicate  which ones are used by
Percolator, q-ranker and Barista.</li>
<li>
Add Percolator to the tab-delimited text table.</li>
</ul>

<p>
Changes we are proposing on the Percolator end of things:</p>
<ul>
<li>
Bundle the main() procedure inside of a callable function.</li>
<li>
We may actually want to produce two or three separate 
tab-delimited text files, akin to what Barista does for PSMs, peptides, and proteins.</li>

<li>
Re-route logging to carp functions
</li>

<li>
Make Percolator produce pep.xml.</li>
<li>
Modify Percolator's tab-delimited text file to resemble those produced
by the other Crux tools.</li>
<li>
Remove the --exp-mass flag and always set it to T.</li>
</ul>

</note>

</blockquote>
</body>
</html>
